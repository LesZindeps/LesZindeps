#{extends 'main.html' /}
#{set pageTitle:'Accueil' /}

<!-- specifique pour cette page -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.1/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/jquery-ui.min.js" type="text/javascript" charset="utf-8"></script>
<link type="text/css" rel="stylesheet" href="@{'/public/stylesheets/openid/openid.css'}"/>
<script type="text/javascript" src="@{'/public/javascripts/openid/openid-jquery.js'}"></script>
<script type="text/javascript" src="@{'/public/javascripts/openid/openid-jquery-en.js'}"></script>
<script src="https://apis.google.com/js/platform.js?onload=gSigninStart" async defer></script>
<script>
    function signInCallback(authResult) {
        if (authResult['code']) {
            // Hide the sign-in button now that the user is authorized
            $('#gSigninButton').attr('style', 'display: none');

            // Send the code to the server
            $.ajax({
                type: 'POST',
                url: 'authenticateWithGSignin',
                data: authResult,
                success: function(result) {
                    $("body").html(result);
                }
            });
        }
    }
</script>

<script type="text/javascript">
    $(document).ready(function() {
        openid.init('openid_identifier');
        openid.setDemoMode(false);
    });
</script>


<div class="grid_8 openIdPanel">
    <h2>Accès privé</h2>

    <!-- Simple OpenID Selector -->
    #{form @authenticateOpenId(), method:'get',id:'openid_form'}
    <input type="hidden" name="action" value="verify"/>

    <fieldset>

        <div id="openid_choice">
            <p>Sélectionnez un fournisseur d'accès Open-ID</p>

            <div id="gSigninButton">
              <span class="g-signin"
                    data-scope="https://www.googleapis.com/auth/userinfo.email"
                    data-clientid="856980994888-o979bp449j9mqdc4ko0cp1njqtocr5cu.apps.googleusercontent.com"
                    data-redirecturi="postmessage"
                    data-accesstype="offline"
                    data-cookiepolicy="single_host_origin"
                    data-callback="signInCallback">
              </span>
            </div>
            <div id="openid_btns"></div>
        </div>

        <div id="openid_input_area">
            <input id="openid_identifier" name="openid_identifier" type="text" value="http://"/>
            <input id="openid_submit" type="submit" value="Sign-In"/>
        </div>
        <noscript>
            <p>OpenID is service that allows you to log-on to many different websites using a single indentity.
                Find out <a href="http://openid.net/what/">more about OpenID</a> and <a
                        href="http://openid.net/get/">how to get an OpenID enabled account</a>.</p>
        </noscript>

        #{/form}
        <!-- /Simple OpenID Selector -->

    </fieldset>

    #{if flash.error}
    <div class="errorbox">
        <h2>Erreur</h2>
        ${flash.error}
    </div>
    #{/if}

    #{if flash.success}
    <div class="successbox">
        ${flash.success}
    </div>
    #{/if}
</div>


<div class="grid_4">
    <p><strong>Question :</strong> comment devenir membre des Zindeps ?</p>

    <p><strong>Réponse :</strong> le groupe n'accepte pas de candidature spontanée. Vous serez sollicité si vous
        connaissez l'un de nous et que votre candidature est retenue par l'ensemble des membres.</p>
</div>
